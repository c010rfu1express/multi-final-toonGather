<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.multi.toonGather.social.model.dao.SocialMapper">
    <!-- 리뷰 작성 -->
    <insert id="createReview" parameterType="ReviewDTO">
        INSERT INTO so_review (webtoon_no, writer_no, title, content, star_rating)
        SELECT #{webtoonNo}, u.user_no, #{title}, #{content}, #{starRating}
        FROM users u
        WHERE u.user_no = #{writer.userNo}
    </insert>



    <!-- ResultMap 정의 -->
    <resultMap id="reviewResultMap" type="ReviewDTO">
        <id property="reviewNo" column="review_no"/>
        <result property="webtoonNo" column="webtoon_no"/>
        <result property="title" column="title"/>
        <result property="content" column="content"/>
        <result property="starRating" column="star_rating"/>
        <result property="createdDate" column="created_date"/>
        <result property="modifiedDate" column="modified_date"/>
        <result property="viewCnt" column="view_cnt"/>
        <association property="writer" javaType="WriterDTO">
            <id property="userNo" column="user_no"/>
            <result property="nickname" column="nickname"/>
            <result property="profileImagePath" column="profile_image_path"/>
        </association>
    </resultMap>
</mapper>